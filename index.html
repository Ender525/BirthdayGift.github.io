<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/png" href="birthday_cake.png" /> 
  <title>Cuenta regresiva ‚è± - Feliz Cumplea√±os Anii üéâ</title>
  <style>
    :root{
      --bg:#000;
      --gold:#ffd36b;
      --neon-gold: 0 0 8px rgba(255,211,107,0.6), 0 0 20px rgba(255,180,40,0.25), 0 0 40px rgba(255,150,20,0.15);
      --neon-1: 0 0 6px rgba(255,80,200,0.35), 0 0 18px rgba(255,80,200,0.12);
      --glass: rgba(255,255,255,0.02);
    }
    html,body{height:100%;margin:0;background:var(--bg);color:#fff;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;}
    .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:28px;box-sizing:border-box;}

    .card{
      width:100%;max-width:920px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:18px;padding:28px;box-shadow:0 8px 30px rgba(0,0,0,0.7);position:relative;overflow:hidden;border:1px solid rgba(255,215,120,0.06);
    }

    /* Decoraciones de Neon */
    .card::before, .card::after{
      content:'';position:absolute;width:90px;height:90px;border-radius:14px;pointer-events:none;mix-blend-mode:screen;opacity:0.65;filter:blur(10px);
    }
    .card::before{top:-18px;left:-18px;background:linear-gradient(135deg,#ff66b2,#ffd36b);}
    .card::after{right:-18px;bottom:-18px;background:linear-gradient(135deg,#6be6ff,#9bff9b);}

    header{display:flex;flex-direction:column;align-items:center;gap:8px;margin-bottom:18px}
    h1{font-size:14px;letter-spacing:2px;color:#ccc;margin:0;text-transform:uppercase}
    .subtitle{font-size:13px;color:#aaa}

    .time-frame{display:flex;flex-direction:column;align-items:center}
    .label{font-size:18px;color:#ddd;margin-bottom:12px;text-align:center}

    .countdown{
      display:flex;gap:12px;flex-wrap:wrap;justify-content:center;align-items:center
    }
    .unit{
      min-width:120px;background:rgba(0,0,0,0.35);border-radius:12px;padding:16px 14px;text-align:center;backdrop-filter:blur(4px);border:1px solid rgba(255,215,120,0.06)
    }
    .value{font-size:26px;font-weight:700;color:var(--gold);text-shadow: var(--neon-gold);letter-spacing:1px}
    .label-unit{font-size:12px;color:#ddd;margin-top:6px}

    /* Panel de Neon :D */
    .congrats{display:none;flex-direction:column;align-items:center;gap:14px;padding:20px}
    .congrats .neon{
      font-size:32px;font-weight:800;text-transform:uppercase;letter-spacing:2px;color:#fff;text-align:center;line-height:1;
      text-shadow: 0 0 8px rgba(255,100,200,0.18), 0 0 20px rgba(255,160,70,0.12), 0 0 36px rgba(120,240,255,0.06);
      animation:pulse 3s infinite;
    }
    @keyframes pulse {
      0% { opacity: 0.8; text-shadow: 0 0 8px rgba(255,100,200,0.25), 0 0 25px rgba(255,160,70,0.15), 0 0 45px rgba(120,240,255,0.1); }
      50% { opacity: 1; text-shadow: 0 0 14px rgba(255,100,200,0.45), 0 0 35px rgba(255,160,70,0.3), 0 0 65px rgba(120,240,255,0.25); }
      100% { opacity: 0.8; text-shadow: 0 0 8px rgba(255,100,200,0.25), 0 0 25px rgba(255,160,70,0.15), 0 0 45px rgba(120,240,255,0.1); }
    }20%,24%,50%{opacity:0.85}
    }

    .heart-wrap{display:flex;align-items:center;gap:12px}
    .heart-svg{width:78px;height:78px;filter:drop-shadow(0 0 12px rgba(255,60,140,0.5));}

    .extra-decor{position:absolute;inset:0;pointer-events:none}
    .glow-ring{position:absolute;inset:-30px;mix-blend-mode:screen;filter:blur(40px);opacity:0.08}

    footer{display:flex;justify-content:space-between;align-items:center;margin-top:18px;color:#999;font-size:12px}

    /* Lienzo de confeti  üéâ*/
    #confetti{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none}

    /* Ajuste Responsivo */
    @media (max-width:600px){.unit{min-width:86px;padding:10px}.value{font-size:20px}.congrats .neon{font-size:22px}.heart-svg{width:56px;height:56px}}

  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="main" aria-live="polite">
      <header>
        <h1>Cuenta especial</h1>
        <div class="subtitle">Cada 22 de noviembre festejare contigo</div>
      </header>

      <div class="time-frame">
        <div class="label">Tiempo Restante:</div>

        <div id="countdownArea">
          <div class="countdown" id="countdown">
            <!-- Unidades Dinamicas -->
          </div>
        </div>

        <div class="congrats" id="congrats">
          <div class="neon">Feliz Cumplea√±os Anii</div>
          <div class="heart-wrap">
            <!-- Corazon Neon SVG -->
            <svg class="heart-svg" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <defs>
                <linearGradient id="g1" x1="0" x2="1">
                  <stop offset="0%" stop-color="#ff66b2" />
                  <stop offset="50%" stop-color="#ffd36b" />
                  <stop offset="100%" stop-color="#6be6ff" />
                </linearGradient>
                <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
                  <feGaussianBlur stdDeviation="3.8" result="b" />
                  <feMerge>
                    <feMergeNode in="b" />
                    <feMergeNode in="SourceGraphic" />
                  </feMerge>
                </filter>
              </defs>
              <style>
                @keyframes heartColorShift {
                  0% { stroke: #ff66b2; }
                  25% { stroke: #ffd36b; }
                  50% { stroke: #6be6ff; }
                  75% { stroke: #9bff9b; }
                  100% { stroke: #ff66b2; }
                }
              </style>
              <path d="M12 21s-7.5-4.7-9.5-7.2C-0.2 8.8 5.1 4 7.9 6.4 10 8.4 12 10 12 10s2-1.6 4.1-3.6C18.9 4 24.2 8.8 21.5 13.8 19.5 16.3 12 21 12 21z"
                fill="none" stroke="#ff66b2" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" filter="url(#glow)" style="animation: heartColorShift 4s infinite;"/>
            </svg>
            <div style="text-align:left">
              <div style="font-weight:700;color:#ffd36b;text-shadow:var(--neon-gold)">Te Amo ‚ù§‚ù§‚ù§</div>
            </div>
          </div>
          <div style="max-width:720px;text-align:center;color:#ddd;font-size:14px;opacity:0.95">Una semana para celebrar üîìü•≥.</div>
        </div>
      </div>

      <canvas id="confetti"></canvas>

      <div class="extra-decor">
        <div class="glow-ring" style="background:radial-gradient(circle at 20% 20%, rgba(255,160,40,0.08), transparent 12%), radial-gradient(circle at 80% 80%, rgba(120,200,255,0.06), transparent 20%);"></div>
      </div>

      <footer>
        <div>Con Amor End</div>
        <div id="note"></div>
      </footer>
    </div>
  </div>

  <script>
    // Meses en Espa√±ol
    const monthsEs = ['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'];

    const countdownEl = document.getElementById('countdown');
    const congratsEl = document.getElementById('congrats');
    const countdownArea = document.getElementById('countdownArea');
    const note = document.getElementById('note');

    const CONFETTI_KEY = 'anii_unlocked_until_v1';

    // determinar el pr√≥ximo 22 de Noviembre en hora local
    function nextNov22(now){
      const year = now.getFullYear();
      // crear 22 de Noviembre a las 00:00:00 hora local
      let candidate = new Date(year, 10, 22, 0,0,0,0); // monthIndex 10 = Nov
      if(now > candidate){
        candidate = new Date(year+1, 10, 22, 0,0,0,0);
      }
      return candidate;
    }

    // crea las unidades de tiempo restantes
    function renderUnits(delta){
      // delta in ms
      if(delta < 0) delta = 0;
      const s = Math.floor(delta/1000)%60;
      const m = Math.floor(delta/60000)%60;
      const h = Math.floor(delta/3600000)%24;
      const d = Math.floor(delta/86400000);
      // Month Day ??? The user wants format Mes Dia Hora Minuto Segundo
      // We'll show month name and day of upcoming Nov 22 plus d h m s

      const target = nextNov22(new Date());
      const month = monthsEs[target.getMonth()];
      const day = target.getDate();

      const units = [
        {v: month + ' ' + day, l: 'Mes D√≠a'},
        {v: String(d).padStart(2,'0'), l: 'D√≠as'},
        {v: String(h).padStart(2,'0'), l: 'Horas'},
        {v: String(m).padStart(2,'0'), l: 'Minutos'},
        {v: String(s).padStart(2,'0'), l: 'Segundos'}
      ];

      countdownEl.innerHTML = '';
      units.forEach(u=>{
        const el = document.createElement('div');el.className='unit';
        const v = document.createElement('div');v.className='value';v.textContent=u.v;
        const la = document.createElement('div');la.className='label-unit';la.textContent=u.l;
        el.appendChild(v);el.appendChild(la);
        countdownEl.appendChild(el);
      });
    }

    // Sistema de confetti (part√≠culas simples en canvas desde los lados) üéâ
    const canvas = document.getElementById('confetti');
    const ctx = canvas.getContext('2d');
    let W,H; function resize(){W=canvas.width=canvas.clientWidth;H=canvas.height=canvas.clientHeight} window.addEventListener('resize',resize); resize();

    const confettiParticles = [];
    function spawnConfettiBurst(fromSide='both', count=80){
      for(let i=0;i<count;i++){
        const side = fromSide==='both'? (Math.random()<0.5?'left':'right'):fromSide;
        const x = side==='left'? -20 : W+20;
        const y = Math.random()*H;
        confettiParticles.push({x,y,vx: (side==='left'? (2+Math.random()*6):(-2-Math.random()*6)), vy: -2+Math.random()*6, size:4+Math.random()*8, rot:Math.random()*360, vr: (Math.random()*6-3), col: randomColor()});
      }
    }
    function randomColor(){
      const palette = ['#ff66b2','#ffd36b','#6be6ff','#9bff9b','#ff8a66','#c37bff'];
      return palette[Math.floor(Math.random()*palette.length)];
    }

    function confettiLoop(){
      ctx.clearRect(0,0,W,H);
      for(let i=confettiParticles.length-1;i>=0;i--){
        const p = confettiParticles[i];
        p.x += p.vx; p.y += p.vy; p.vy += 0.12; p.rot += p.vr;
        // dibujar rect√°ngulo rotado
        ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.rot*Math.PI/180);
        ctx.fillStyle = p.col; ctx.fillRect(-p.size/2,-p.size/2,p.size,p.size*0.6);
        ctx.restore();
        // eliminar si est√° fuera de pantalla
        if(p.y>H+40 || p.x < -80 || p.x>W+80) confettiParticles.splice(i,1);
      }
      requestAnimationFrame(confettiLoop);
    }
    confettiLoop();

    // estado del conteo regresivo 
    let intervalId = null;

    function startCountdown(){
      if(intervalId) clearInterval(intervalId);
      intervalId = setInterval(()=>{
        const now = new Date();
        const target = nextNov22(now);
        const delta = target - now;
        if(delta<=0){
          // conteo regresivo terminado -> desbloquear semana üîì
          unlockWeekFromNow();
          showCongrats();
          spawnConfettiBurst('both',140);
          return;
        }
        renderUnits(delta);
      },250);
      // primera renderizaci√≥n inmediata
      const now = new Date(); renderUnits(nextNov22(now)-now);
      countdownArea.style.display='block'; congratsEl.style.display='none';
      note.textContent = '';
    }

    function showCongrats(){
      if(intervalId){ clearInterval(intervalId); intervalId=null; }
      countdownArea.style.display='none'; congratsEl.style.display='flex';
    }

    // desbloquear semana: establecer almacenamiento local para marcar el fin de la semana de celebraci√≥n
    function unlockWeekFromNow(){
      // Determinar 22 de Noviembre de este a√±o
      const now = new Date();
      let endingStart = new Date(now.getFullYear(),10,22,0,0,0,0);
      // si la fecha actual es despu√©s del 22 de Noviembre (mismo d√≠a) pero antes del 22 de Noviembre del pr√≥ximo a√±o, usamos el 22 de Noviembre de este a√±o
      if(now < endingStart){
        // si ahora es antes del 22 de Noviembre entonces esta funci√≥n no deber√≠a ser llamada, pero mantenemos la l√≥gica
      }
      const weekEnd = new Date(endingStart.getTime() + 7*24*3600*1000);
      localStorage.setItem(CONFETTI_KEY, String(weekEnd.getTime()));
    }

    function checkWeekUnlocked(){
      const val = localStorage.getItem(CONFETTI_KEY);
      if(!val) return false;
      const t = Number(val);
      const now = Date.now();
      if(now <= t){
        return true;
      }else{
        localStorage.removeItem(CONFETTI_KEY);return false;
      }
    }

    // al cargar la p√°gina, inicializar
    (function init(){
      const now = new Date();
      // si estamos actualmente en la semana de celebraci√≥n para el 22 de Noviembre de este a√±o
      const thisNov22 = new Date(now.getFullYear(),10,22,0,0,0,0);
      const nextNov = nextNov22(now);

      // Si el almacenamiento local indica semana desbloqueada, mostrar felicitaciones y confetti
      if(checkWeekUnlocked()){
        showCongrats(); spawnConfettiBurst('both',120);
        note.textContent = 'Semana de celebraci√≥n ‚Äî contenido desbloqueado';
        return;
      }

      // Si hoy est√° dentro de los 7 d√≠as despu√©s del 22 de Noviembre de este a√±o, tambi√©n desbloquear
      const afterThisNov = now - thisNov22;
      if(afterThisNov>=0 && afterThisNov <= 7*24*3600*1000){
        // dentro de la semana de celebraci√≥n
        const weekEnd = new Date(thisNov22.getTime() + 7*24*3600*1000);
        localStorage.setItem(CONFETTI_KEY, String(weekEnd.getTime()));
        showCongrats(); spawnConfettiBurst('both',120);
        note.textContent = 'Semana de celebraci√≥n ‚Äî contenido desbloqueado';
        return;
      }

      // de lo contrario iniciar conteo regresivo normalmente
      startCountdown();
    })();

    // Adem√°s: si el usuario hace clic en cualquier lugar durante la semana de celebraci√≥n, generar confetti lateral
    document.addEventListener('click', function(){ if(checkWeekUnlocked()){ spawnConfettiBurst('both',80); } });

    // Extra: accesibilidad: permitir activaci√≥n por teclado
    document.addEventListener('keydown', function(e){ if(e.key==='Enter' && checkWeekUnlocked()){ spawnConfettiBurst('both',80); } });

    // Peque√±a optimizaci√≥n: asegurar que el canvas se redimensiona con la tarjeta
    const observer = new ResizeObserver(()=>{resize();}); observer.observe(document.querySelector('.card'));

    // Prevenir que el conteo regresivo se detenga cuando la pesta√±a est√° oculta? Actualizamos mediante intervalo; est√° bien. 
    //Fin del archivo por Ender :D
  </script>
</body>
</html>


